<!DOCTYPE html>
<head>
<title>	&#127809; AGro User Interface</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles.css">

</head>

<body>

	<h1> USER INTERFACE v1.21.1</h1>

	<div  id="content"	class="row">
		<table id="table">
			<tr id="row">
				<td>
					<div id="button"	class="inputs"	>
						<img src="icon/light.png">	
						<h3>Light</h3>
					</div>
				</td>

				<td>
					<div id="button"	class="inputs"	>
						<img src="icon/pipe.png">	
						<h3>Pump</h3>
					</div>
				</td>

				<td>
					<div id="button"	class="inputs"	>
						<img src="icon/food.png">	
						<h3>Manual Feed</h3>
					</div>
				</td>

				<td>
					<div id="button"	class="inputs"	>
						<img src="icon/water.png">	
						<h3>Filter</h3>
					</div>
				</td>
			</tr>

			<tr id="row">
				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="changeOn();" id="clicker">
							  <span class="someText"  id="textOn">ON</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="changeOff();" id="clicker">
							  <span class="someText"  id="textOff">OFF</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="pumpOn();" id="clicker">
							  <span class="someText"  id="pumpOn">ON</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="pumpOff();" id="clicker">
							  <span class="someText"  id="pumpOff">OFF</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="feedOn();" id="clicker">
							  <span class="someText"  id="feedOn">ON</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="feedOff();" id="clicker">
							  <span class="someText"  id="feedOff">OFF</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="fltrOn();" id="clicker">
							  <span class="someText"  id="fltrOn">ON</span>
							</div> 
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="fltrOff();" id="clicker">
							  <span class="someText"  id="fltrOff">OFF</span>
							</div> 
						</h3>
					</div>
				</td>
			</tr>

		</table>
			<br>

		<table id="status">
			<tr id="row">
				<td>
					<div id="symbol"	class="inputs"	>
						<img src="icon/acid.png">	
					</div>
				</td>

				<td>
					<div id="display"	class="inputs"	>
						<h3>pH Level &#58;
							<span class="analogvalue" id="phvalue">none</span>
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="phRef();" id="clicker">
							  <span class="someText"  id="refresh">REFRESH</span>
							</div> 
						</h3>
					</div>
				</td>
			</tr>

			<tr id="row">
				<td>
					<div id="symbol"	class="inputs"	>
						<img src="icon/temp.png">	
					</div>
				</td>

				<td>
					<div id="display"	class="inputs"	>
						<h3>Temperature &#58;
							<span class="analogvalue" id="temperaturevalue">none</span>	
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="tempRef();" id="clicker">
							  <span class="someText"  id="refresh">REFRESH</span>
							</div> 
						</h3>
					</div>
				</td>
			</tr>

			<tr id="row">
				<td>
					<div id="symbol"	class="inputs"	>
						<img src="icon/food.png">	
					</div>
				</td>

				<td>
					<div id="display"	class="inputs"	>
						<h3>Food Level &#58;
							<span class="analogvalue" id="foodvalue">none</span>
						</h3>
					</div>
				</td>

				<td>
					<div id="label"	class="inputs"	>
						<h3 id="headLabel">
							<div class="button" id="buttonLabel">
							  <input type="button" onClick="foodRef();" id="clicker">
							  <span class="someText"  id="refresh">REFRESH</span>
							</div> 
						</h3>
					</div>
				</td>
			</tr>
		</table>
			
		</div>

	</div>

	<script>
		var tempdata;
		var phdata;
		var fooddata;
		var celsius;
		var textdata = "XD";
		var appOn = "ON";
		var appOff = "OFF";
		var appTest = "TEST";

		var feeder;

		setup();

		function setup(){
			if(cpf){
				cpf.setPinMode('["resetPin"],["setPinMode", "analog", 0,"INPUT"]'); 
				cpf.setPinMode('["resetPin"],["setPinMode", "digital", 6,"OUTPUT"]'); 
				cpf.setPinMode('["resetPin"],["setPinMode", "digital", 7,"OUTPUT"]'); 
				cpf.setPinMode('["resetPin"],["setPinMode", "digital", 13,"OUTPUT"]'); 
				cpf.setPinMode('["resetPin"],["setPinMode", "digital", 12,"INPUT"]');
				cpf.setPinMode('["resetPin"],["setPinMode", "digital", 3,"SERVO"]');  
				cpf.setPinMode('["resetPin"],["grove_rgblcd_begin", 16, 2]');
			}
			//document.getElementById("demo").innerHTML += ret + "<br>";
		}

		function loop() {
			if(cpf){
		
				tempdata = cpf.get("temperature sensor");
				feeder = cpf.get("d12");
				celsius = toCelsius(tempdata);	
				phRef();
				tempRef();
				
			}
			setTimeout(loop, 1000);
		}
		loop();

	// Temperature
		function toCelsius(value) {
			var resistance = parseFloat((1023 - value) * 10000 / value);
			var temperature = 1 / (Math.log(resistance / 10000) / 3975+1 / 298.15) - 273.15;
			
			return temperature.toFixed(2);
		}

	// UI Digital Pins

		function changeOn(){
				document.getElementById("textOn").innerHTML = textdata;
				document.getElementById("textOff").innerHTML = appOff;
				cpf.request('["digitalWrite", 7 , 1]'); 
		}
		function changeOff(){
				document.getElementById("textOn").innerHTML = appOn;
				document.getElementById("textOff").innerHTML = textdata;
				cpf.request('["digitalWrite", 7 , 0]'); 
		}

		function pumpOn(){
				document.getElementById("pumpOn").innerHTML = textdata;
				document.getElementById("pumpOff").innerHTML = appOff;
				cpf.request('["digitalWrite", 13 , 1]');
		}
		function pumpOff(){
				document.getElementById("pumpOn").innerHTML = appOn;
				document.getElementById("pumpOff").innerHTML = textdata;
				cpf.request('["digitalWrite", 13 , 0]'); 
		}
	
		function feedOn(){
				document.getElementById("feedOn").innerHTML = textdata;
				document.getElementById("feedOff").innerHTML = appOff;
				cpf.request('["analogWrite", 3 , 130]'); 
		}
		function feedOff(){
				document.getElementById("feedOn").innerHTML = appOn;
				document.getElementById("feedOff").innerHTML = textdata;
				cpf.request('["analogWrite", 3 , 0]'); 
		}

		function fltrOn(){
				document.getElementById("fltrOn").innerHTML = textdata;
				document.getElementById("fltrOff").innerHTML = appOff;
				cpf.request('["digitalWrite", 6 , 1]'); 
		}
		function fltrOff(){
				document.getElementById("fltrOn").innerHTML = appOn;
				document.getElementById("fltrOff").innerHTML = textdata;
				cpf.request('["digitalWrite", 6 , 0]'); 
		}

		function tempRef(){
				document.getElementById("temperaturevalue").innerHTML = celsius;
				cpf.request('["analogWrite", 3, 1]');
		}

		function phRef(){
					
					if(feeder == 1){
						document.getElementById("phvalue").innerHTML = appOn;
				  	}
				  	else{
						document.getElementById("phvalue").innerHTML = appOff;
					}  
		}

		function foodRef(){
			cpf.request('["analogWrite", 3, 120]');

		}


	</script>



</body>